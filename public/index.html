<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <title>vue-hello-world</title>
  </head>
  <body>
  <script language="javascript">
    var xhr = new XMLHttpRequest();
    console.log('text');
    xhr.open('GET', 'https://timetreeapis.com/calendars/JuVYCgDXj8GE/upcoming_events?timezone=Asia/Tokyo&days=3', true);
    xhr.setRequestHeader('Accept', 'application/vnd.timetree.v1+json');
    xhr.setRequestHeader('Authorization', 'Bearer ZruUA-PdzbMrjT8jGNi4qNPE5yK1svGELVUUIoL1bktJxWTd');
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                var data = JSON.parse(xhr.responseText);
                var http = new XMLHttpRequest();
                var url = 'https://notify-api.line.me/api/notify';
                var params = `message=${xhr.responseText}`;
                http.open('POST', url, true);

                //Send the proper header information along with the request
                http.setRequestHeader('Authorization', 'Bearer XKRV9un7zmsIFq2693U3wttovzTYSWTLDtiZszmiQLq');

                http.onreadystatechange = function() {//Call a function when the state changes.
                    if(http.readyState == 4 && http.status == 200) {
                        alert("Success!");
                    }
                }
                http.send(params);
                // do something with data
            } else {
                //handle errors
            }
        }
    };
    xhr.send();
  </script>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>
